/*******************/
function VectorG2(r,tr_psi,l,p,k,h2,v)
        u:=2*EulerPhi(k);
	B:=RMatrixSpace(Integers(), u,u)!0;
	B[1][1]:=r;
	for i:=2 to u do
	    B[i][1]:=-l^(i-1);B[i][i]:=1;
	end for;
	L:=LatticeWithBasis(B);
	S:=ShortestVectors(L);
	R<x>:=PolynomialRing(Integers());
	for i:=1 to #S do
	    C:=S[i];
	    b:=R!Eltseq(C);
            assert Resultant(b, x^2-tr_psi*x+p) mod r eq 0;
	    h2d:=Resultant(b, x^2-tr_psi*x+p) div r;
	    if GCD(h2,h2d) eq 1 then
		return C;
	    end if;
	end for;
	min:=Norm(ShortestVector(L));max:=v*min;
	V:=ShortVectorsProcess(L, min, max);
	repeat
	    C:=NextVector(V);
	    if Norm(C) eq 0 then
	        return "NULL";
	    end if;
	    b:=R!Eltseq(C);
            assert Resultant(b, x^2-tr_psi*x+p) mod r eq 0;
	    h2d:=Resultant(b, x^2-tr_psi*x+p) div r;
	until GCD(h2,h2d) eq 1;
	return C;
end function;

//*************************************Curve parmamters*************************//
printf("BW10-480:\n");
x:=1168231415840;
r:=x^8-x^6+x^4-x^2+1;
t:=-x^6+x^4-x^2+2;
p:=(x^12-x^10+x^8-5*x^6+5*x^4-4*x^2+4) div 4;
f:=2^15*3^2*5^3*7*73^3*79*139^3*719567^3*14787739441*18543355807;
lambda_g2:=-x^5;
l:=p*lambda_g2;
tr_psi:=f;
h2:=3171040993209066944361785717683026903414526271830594515170176757585794152628176\
1593490504821089471542406597421940731089612688520836037757452684406296032026432\
0676916442110183728694815959435529967547408828500063310018435691894296931260181\
6741730500786962173567985902142909272660356330738402147505298149198792958249228\
0544819362753542986426800803598218027865252554710881413909488483439308646210498\
4097209412166823502232788753729857224828044300862158704094815006396985727086741\
8410917410309367490536224349030199700011610641585702739307738001699345283184120\
228997779641811334255023575051928040316927484169082914813495947192166404;
k:=10;
v:=2;
VectorG2(r,tr_psi,l,p,k,h2,v);

printf("BW10-511:\n");
x:=2^7+2^13+2^26-2^32; 
r:=x^8+x^7-x^5-x^4-x^3+x+1;
t:=x^3+1;
p:=(x^3-1)^2*(x^10-x^5+1)div 3 +x^3;
lambda_g2:=x^10;
f:=3*5*7*19*61*74172809*103039397557*18033575676307*13953720972139393*290785498341800690827267;
tr_psi:=-(t-3*f) div 2;
l:=p*lambda_g2;
k:=10;
h2:=4954543381794982310222378735186311862476836158330935757216355292810385174416711\
9383828092987939032246891046257558101083384866259520124994569576775948227187932\
1987737000285706097590881510505246597110320954797497423214664939248187677256452\
0102363212153590143020381338670127376287416260159300433890260680570215512469001\
0572475214925612918998623545701954898449104130681793362999047460999718321485407\
5831262462519663868973232566532465755248360743100875449797146283208166211671276\
1831029395685810732314338468737841837258354016634530006809751036492354216299662\
2586218848302341694876032945542487735652839602620832205383355858827326279599572\
14254322822258882945078153185738661454694510105508543391875;
v:=1;
VectorG2(r,tr_psi,l,p,k,h2,v);

printf("BW10-512:\n");
x:=2^36+2^35+2^32+2^17+2^3+1;
r:=x^8-x^6+x^4-x^2+1;
t:=x^2+1;
p:=(x^14-2*x^12+x^10+x^4+2*x^2+1) div 4;
lambda_g2:=-x^5;
f:=2^4*3^5*5*7^2*137^5*419*617*1531^5*3119*41081*88789*170641^5;
tr_psi:=-f;
l:=p*lambda_g2;
h2:=8044977791883821006050567647842058176565953628518065682542556060926135486089108\
4553676271822477655175487396876971151712132787437758728023493524704345601108520\
8537083352030833770361153333471198986205241782839735063101404287348004826246121\
9080161232562531994099976503179881861831346891394931850815308516369008079342485\
1487669666086571196633111843848015759712739936123559933879170242662016921075289\
4591631264137331886415163937523274311004018562507626250510488868689482699414894\
9632354689355485774863886383626358798237187122964742154226974327256372655471672\
4600046591673782087638727184041056612071221934836008832321743224302548539143393\
9657769090904223658945664115107923652970681362724;
k:=10;
v:=2;
VectorG2(r,tr_psi,l,p,k,h2,v);

printf("BW14-340:\n");
x:=2^2+2^7+2^9-2^13+2^19+2^21;
r:=x^12 + x^11 - x^9 - x^8 + x^6 - x^4 - x^3 + x + 1;
t:=x^8-x+1;
p:=(x-1)^2*(x^14-x^7+1) div 3+x^15;
f:=3*53*331*727*14584517*1301753080662918159576503854656309391;
lambda_g2:=-x^14-1;
tr_psi:=-(t-3*f) div 2;
l:=p*lambda_g2;
k:=14;
h2:=2448590558432845124514616126556011809545162516882815899290631366160391232562874\
4192070096942601508456210769672486308146805691063840066637168841736473050361034\
8922416598017443011798257959913739436795488701619061641087541633205799763300461\
0427439206002660290242922147219606118013160092189935674102376970449419141031437\
3631071054709330278058559671457954621124715068736144504260617262674461610523342\
2210082249075341997109344163206899969731515566584772253625827785420253207832800\
7738676209940663526074006340766640729366570769011962112968102362048476175451115\
3170992164598313355591890077196129216219747712738481276387564826684435762064754\
9533241;
v:=2;
VectorG2(r,tr_psi,l,p,k,h2,v);


printf("BW14-351:\n");
x:=-4214720;
r:=x^12 + x^11 - x^9 - x^8 + x^6 - x^4 - x^3 + x + 1;
f:=(x^8+2*x^7+x-1) div 3;
t:=x^8-x+1;
p:=(x-1)^2*(x^14-x^7+1) div 3+x^15;
tr_psi:=-(t-3*f) div 2;
lambda_g2:=-x^14-1;
l:=p*lambda_g2;
k:=14;
h2:=1370955650741392130488719857238355165853217563740001057338343376432359811257449\
3169281570045503449204704361036601477941831705436118538078589364672893952320161\
6588570247469523275196970542624619777787797019021080351185206702993489647675110\
0477056883645372065925989928616755661712036967712928189183421438698964594267104\
8697064308532970310505979191313556421241358959101154664354256877047794633169733\
9432833226320391859479082990840957047341310451124742561075592371994790102347805\
2655046957734407024476095674647162465127373498965601594378855657629381131544859\
9143568688288916768533977298065781849100493302057016056773883169829998460843597\
5724435153783493574421645201;
v:=2;
VectorG2(r,tr_psi,l,p,k,h2,v);


printf("BW14-382:\n");
x:=2565121;
r:=x^12-x^10+x^8-x^6+x^4-x^2+1;
t:=1+x^2;
p:=(x^18-2*x^16+x^14+x^4+2*x^2+1) div 4;
f:=2^11*3*5*7*13^7*23^14*43*167*373^7*4261;
tr_psi:=-f;
lambda_g2:=-x^7;
l:=p*lambda_g2;
h2:=2653845659599558485345719849052911670535570958830292888884578598827366410060429\
5821554794153529028386557305872634903934932198199238745173692981655908988911223\
8640916302793866942678043963758196937526343878839229059113113632739656182921865\
0013153580087307464141578876358740613659589552484749507343853842348284780174643\
5852168727283979040746809094475680250324737383363450170316457399787342410845693\
7476906740465638200894849491370040430583495351038251309837555858164097817005788\
8356566172568753245845865010268003233568120665195709155235320213988273252596917\
4893653429032709282236011042860167786086163700181662923566356855327644356192810\
1597155222117079678744909936671949168873467689262794829804349343928176019047844\
3150167045345284;
k:=14;
v:=2;
VectorG2(r,tr_psi,l,p,k,h2,v);
